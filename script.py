from PlayChess import puzzle, contest
from PlayChess import db

from bson.objectid import ObjectId

db.users.update({'username': 'alwayswannaly'}, {'$pull': {'contests': {} }})
db.users.update({'username': 'alwayswannaly'}, {'$pull': {'puzzles': {} }})
db.users.update({'username': 'neverwannafly'}, {'$pull': {'contests': {} }})
db.users.update({'username': 'neverwannafly'}, {'$pull': {'puzzles': {} }})

db.puzzle.remove({})
db.contest.remove({})

contest.create_contest(db, "DTUCHT19", None, None)
cntst = contest.loadContest(db, "DTUCHT19")

cntst.update_details(db,"""<div class=\"container board heading raised\"><h1><u>DTU CHESS TRIALS</u></h1></div><div class=\"container board raised\"><center><h5> Important Rules for Puzzle Round </h5><h6>(The puzzle round will be held on 24th August between 6PM-10PM)</h6></center><hr width='90%' height='10%' color='beige'><ul><li>Solving a puzzle successfully will give you 1 point. Partial markings will also be given on puzzles whose solution is more than 1 move depending on how much of it you solve.</li><li>There is no negative marking if you fail at a puzzle</li><li>No tiebreakers would be used to resolve ties. People with same score will be treated as same rank</li><li>Once you start, you'll need to finish the contest within 20 minutes.</li><li>If you skip a puzzle, you wont be able to attempt it.</li><li>You would be given only 1 attempt at solving a puzzle. If you accidentally selected a wrong square, you can deselect it by clicking anywhere except a valid move square. No excuses like misclick would be entertained.</li><li>Leaderboards would be displayed after the contest concludes.</li></ul></div>""", "DTUCHT19")

p1 = puzzle.createPuzzle(db, "6k1/ppR5/3B2p1/3p4/4rnK1/5P2/PP1r3P/8 b - - 0 0", ['d2-g2', 'g4-h4', 'g6-g5'], ['Mate in Two'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "2r3r1/1RQ5/1P1qk3/3p1p1p/3p3P/3BbP2/PP4P1/5K1R w - - 1 2", ['c7-f7', 'e6-e5', 'f7-f5'], ['Mate in Two'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "1r6/p6k/5p2/5q1p/P1pPp3/2P1P2P/1R3P2/2R1Q2K b - - 0 1", ['f5-h3', 'h1-g1', 'b8-g8'], ['Mate in Two'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "5r1k/p5p1/1p4Rp/1P1QR3/2Pp4/3P3P/6PK/2q2r2 b - - 1 1", ['f1-h1', 'h2-g3', 'c1-f4'], ['Mate in Two'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "6nk/pp2qr1p/3N1n1B/2p3Q1/8/3p4/PPPK1P1P/R5R1 b - - 1 1", ['e7-e2', 'd2-c3', 'e2-c2'], ['Mate in Two'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "8/7p/1p5k/p1p4P/2P3PK/r1P2R2/8/8 w - a6 0 2", ['f3-f7', 'a3-c3', 'g4-g5'], ['Mate in Two'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "4r1r1/kbRK1N2/p7/Pp1p4/1P1P4/4B3/5P2/8 w - - 1 2", ['c7-b7', 'a7-b7', 'f7-d6'], ['Fork', 'Double Attack'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "5r1k/6b1/p6N/3qp3/7Q/6p1/P4P2/2R3K1 w - - 0 2", ['h6-f5', 'h8-g8', 'f5-e7'], ['Fork', 'Discovery'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "r1b2rk1/p2p1ppp/1p6/2pqP3/3pN3/Q7/P4PPP/2R1R1K1 w - - 1 2", ['e4-f6', 'g8-h8', 'f6-d5'], ['Fork', 'Backrank Weakness'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "rn1qkb1r/pp3ppp/4bn2/2p1N3/2Bp4/8/PPP1QPPP/RNB1K2R w KQkq - 1 2", ['e5-f7', 'd8-d7', 'c4-e6'], ['Fork', 'Pin'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "N1bk3r/pp1pnppp/2nQ4/3q4/8/4P1P1/PPPN3P/R3KB2 w Q - 1 2", ['d6-c7', 'd8-e8', 'c7-c8'], ['Fork', 'Sacrifice'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "1r2Rrk1/p2P2p1/1p3b1p/5p2/1P6/P5P1/5P1P/4R1K1 w - - 0 2", ['e8-b8', 'f8-b8', 'e1-e8'], ['Backrank Weakness', 'Passed Pawn'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "r4rk1/pp1n1p1p/3p2p1/2pP3n/Q2bPP1q/2NB1N1b/PP4P1/R1B2R1K b - - 1 1", ['h3-g2', 'h1-g2', 'h4-g3', 'g2-h1', 'g3-h3', 'f3-h2', 'h5-g3'], ['Discovery', 'Mate in 4'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "r3k2r/pppq1ppp/2n5/5b2/1bP1n3/P1N1BQ2/1P2NPPP/R3KB1R b KQkq - 1 1", ['c6-e5'], ['Queen Trap'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "4k1r1/pp1n3p/3b1n1B/2p1P3/3P1p2/1Q1P3q/PP4P1/R4RK1 w - - 1 2", ['b3-g8'], ['Hanging Piece'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "r3r1k1/ppQ1n1pp/q7/4Nb2/3P4/2P4P/P4PP1/R1B1K2R b KQ - 1 1", ['a8-c8'], ['Queen Trap'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "1k6/pp6/2pb4/3p4/6B1/2P2R1P/PP4P1/4q1BK w - - 1 2", ['f3-e3', 'e1-e3', 'g1-e3'], ['Queen Trap', 'Backrank Weakness'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "3q1rk1/p1pn1p2/1rQb3p/4p1p1/4N3/6B1/PPP2PPP/3R1RK1 w - - 1 2", ['c6-d7', 'd8-d7', 'e4-f6'], ['Fork'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "8/3k4/1K6/8/4BR2/4p3/4p3/8 w - - 0 1", ['e4-f5', 'd7-d6', 'f4-d4', 'd6-e5', 'd4-e4'], ['Endgame'])
cntst.add_puzzle(db, p1.inserted_id)
p1 = puzzle.createPuzzle(db, "8/8/1pp5/1qk1K2B/1p1R4/8/2PP4/8 w - - 0 1", ['d4-d5', 'c6-d5', 'd2-d4'], ['Endgame', 'Skewer', 'Sacrifice'])
cntst.add_puzzle(db, p1.inserted_id)